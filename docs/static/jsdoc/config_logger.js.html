<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: config/logger.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: config/logger.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @file Configuration information for Winston logger
 * @author Russell Feldhausen &lt;russfeld@ksu.edu>
 * @exports logger a Winston logger object
 */

// Import libraries
import winston from "winston";
import { format } from "winston";

// Extract format options
const { combine, timestamp, printf, colorize, align, errors } = winston.format;

/**
 * Custom formatter for Sequelize Logs
 */
const sequelizeErrors = format((info) => {
  // Adapted from https://github.com/sequelize/sequelize/issues/14807#issuecomment-1853514339
  if (info instanceof Error &amp;&amp; info.name.startsWith("Sequelize")) {
    if (info.parent) {
      let { message } = info.parent;
      if (info.sql) {
        message += "\nSQL: " + info.sql;
      }

      if (info.parameters) {
        const stringifiedParameters = JSON.stringify(info.parameters);
        if (
          stringifiedParameters !== "undefined" &amp;&amp;
          stringifiedParameters !== "{}"
        ) {
          message += "\nParameters: " + stringifiedParameters;
        }
      }
      // Stack is already included in the error
      // message += "\n" + info.stack;

      // Update the message
      info.message = info.message += "\n" + message;
    }
  }
  return info;
});

// Custom logging levels for the application
const levels = {
  error: 0,
  warn: 1,
  info: 2,
  http: 3,
  verbose: 4,
  lti: 5,
  debug: 6,
  sql: 7,
  silly: 8,
};

// Custom colors
const colors = {
  error: "red",
  warn: "yellow",
  info: "green",
  http: "white",
  verbose: "cyan",
  lti: "magenta",
  debug: "blue",
  sql: "gray",
  silly: "gray",
};

export default function configureLogger(level = "info") {
  winston.addColors(colors);

  return winston.createLogger({
    // Default logging level
    level: level,
    levels: levels,
    // Format configuration
    // See https://github.com/winstonjs/logform
    format: combine(
      sequelizeErrors(),
      errors({ stack: true }),
      colorize({ all: true }),
      //shortFormat(),
      timestamp({
        format: "YYYY-MM-DD hh:mm:ss.SSS A",
      }),
      align(),
      printf(
        (info) =>
          `[${info.timestamp}] ${info.level}: ${info.stack ? info.message + "\n" + info.stack : info.message}`,
      ),
    ),
    // Output configuration
    transports: [new winston.transports.Console()],
    exceptionHandlers: [new winston.transports.Console()],
    rejectionHandlers: [new winston.transports.Console()],
  });
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="config_database.module_js.html">config/database.js</a></li><li><a href="config_logger.module_js.html">config/logger.js</a></li><li><a href="config_migrations.module_js.html">config/migrations.js</a></li><li><a href="controllers_consumer.module_js.html">controllers/consumer.js</a></li><li><a href="controllers_lti.module_js.html">controllers/lti.js</a></li><li><a href="controllers_provider.module_js.html">controllers/provider.js</a></li><li><a href="lib_lti10.module_js.html">lib/lti10.js</a></li><li><a href="lib_lti13.module_js.html">lib/lti13.js</a></li><li><a href="migrations_00_consumers.module_js.html">migrations/00_consumers.js</a></li><li><a href="migrations_00_providers.module_js.html">migrations/00_providers.js</a></li><li><a href="routes_consumer.module_js.html">routes/consumer.js</a></li><li><a href="routes_provider.module_js.html">routes/provider.js</a></li></ul><h3>Classes</h3><ul><li><a href="controllers_consumer.module_js-ConsumerController.html">ConsumerController</a></li><li><a href="controllers_lti.module_js-LTIToolkitController.html">LTIToolkitController</a></li><li><a href="controllers_provider.module_js-ProviderController.html">ProviderController</a></li><li><a href="lib_lti10.module_js-LTI10Utils.html">LTI10Utils</a></li><li><a href="lib_lti13.module_js-LTI13Utils.html">LTI13Utils</a></li></ul><h3>Global</h3><ul><li><a href="global.html#ConsumerSchema">ConsumerSchema</a></li><li><a href="global.html#ProviderSchema">ProviderSchema</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Sat Jan 24 2026 22:17:39 GMT+0000 (Coordinated Universal Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>

---
title: "Database Schema"
pre: "1. "
weight: 10
---

![Database Diagram](images/database.png)

## System Managed Tables

### lti_migrations

This is the migrations table managed by [Umzug](https://github.com/sequelize/umzug). It tracks any changes that must be made to the database schema as future versions are released.

## LTI Consumers

### lti_consumers

This table stores data about LTI Consumers connected to this system. 

* `id` - autogenerated database ID field
* `name` - user-friendly name of the LTI Consumer
* `lti13` - boolean value representing if the LTI Consumer supports LTI 1.3 connections
* `key` - {{% badge %}}Both{{% /badge %}} autogenerated internal key used to identify the LTI Consumer
  * This key is used in lieu of the database ID to prevent guessing attacks against sequential values. The key is generated using [nanoid](https://www.npmjs.com/package/nanoid)
* `client_id` - {{% badge %}}LTI 1.3{{% /badge %}} client ID provided by the LTI Consumer
* `platform_id` - {{% badge %}}LTI 1.3{{% /badge %}} platform ID of the LTI Consumer
* `deployment_id` - {{% badge %}}LTI 1.3{{% /badge %}} deployment ID from the LTI Consumer
* `keyset_url` - {{% badge %}}LTI 1.3{{% /badge %}} JWKS keyset URL for the LTI Consumer 
* `token_url` - {{% badge %}}LTI 1.3{{% /badge %}} Token URL for the LTI Consumer
* `auth_url` - {{% badge %}}LTI 1.3{{% /badge %}} Authentication URL for the LTI Consumer
* `tc_product` - {{% badge %}}Both{{% /badge %}} {{% badge %}}Auto{{% /badge %}} Product Information for the LTI Consumer 
* `tc_version` - {{% badge %}}Both{{% /badge %}} {{% badge %}}Auto{{% /badge %}} Version of the LTI Consumer
* `tc_guid` - {{% badge %}}Both{{% /badge %}} {{% badge %}}Auto{{% /badge %}} GUID of the LTI Consumer
* `tc_name` - {{% badge %}}Both{{% /badge %}} {{% badge %}}Auto{{% /badge %}} Name of the LTI Consumer
* `createdAt` - {{% badge %}}Auto{{% /badge %}} creation timestamp
* `updatedAt` - {{% badge %}}Auto{{% /badge %}} last updated timestamp

### lti_consumer_keys

This table stores the secrets associated with an LTI Consumer. It is stored in a separate table to prevent accidental modification through the `Consumer` model directly. 

* `key` - {{% badge %}}Auto{{% /badge %}} autogenerated internal key used to identify the LTI Consumer
* `secret` - {{% badge %}}LTI 1.0{{% /badge %}} shared secret with the LTI Consumer
* `public` - {{% badge %}}LTI 1.3{{% /badge %}} public key used in connections with the LTI Consumer
* `private` - {{% badge %}}LTI 1.3{{% /badge %}} paired private key used in connections with the LTI Consumer

### lti_consumer_logins

This table stores login requests from LTI Consumers via the LTI 1.3 protocol. Entries in this table are automatically expired after 15-20 minutes (check every 5 minutes, entries older than 15 minutes are removed)

* `key` - {{% badge %}}Auto{{% /badge %}} autogenerated internal key used to identify the LTI Consumer
* `state` - {{% badge %}}Auto{{% /badge %}} autogenerated internal state shared with the LTI Consumer. Generated using [nanoid](https://www.npmjs.com/package/nanoid)
* `nonce` - {{% badge %}}Auto{{% /badge %}} autogenerated internal nonce shared with the LTI Consumer. Generated using [nanoid](https://www.npmjs.com/package/nanoid)
* `iss` - Issuer of the login request from the LTI Consumer
* `client_id` - client ID provided by the LTI Consumer
* `keyset_url` - JWKS keyset URL for the LTI Consumer 
* `createdAt` - {{% badge %}}Auto{{% /badge %}} creation timestamp
* `updatedAt` - {{% badge %}}Auto{{% /badge %}} last updated timestamp

### lti_oauth_nonces

This table stores nonces provided by the LTI Consumer via the LTI 1.0 protocol. Entries in this table are automatically expired after 15-20 minutes (check every 5 minutes, entries older than 15 minutes are removed)

* `key` - {{% badge %}}Auto{{% /badge %}} autogenerated internal key used to identify the LTI Consumer
* `nonce` - nonce value provided by the LTI Consumer in the connection. 
* `createdAt` - {{% badge %}}Auto{{% /badge %}} creation timestamp
* `updatedAt` - {{% badge %}}Auto{{% /badge %}} last updated timestamp

## LTI Providers

### lti_providers

This table stores information about LTI Tool Providers connected to this system. 

* `id` - autogenerated database ID field
* `name` - user-friendly name of the LTI Tool Provider
* `lti13` - boolean value representing if the LTI Tool Provider supports LTI 1.3 connections.
  * **LTI 1.3 is currently not implemented for LTI Tool Providers**
* `key` - {{% badge %}}Both{{% /badge %}} shared key used to identify the LTI Tool Provider
* `launch_url` - {{% badge %}}LTI 1.0{{% /badge %}} the launch URL for LTI 1.0 connections to the LTI Tool Provider
* `domain` - {{% badge %}}LTI 1.0{{% /badge %}} the base domain name of the LTI Tool Provider
* `custom` - {{% badge %}}LTI 1.0{{% /badge %}} custom launch variables provided as part of the LTI 1.0 connection to the LTI Tool Provider
  * **Custom Variables are not currently implemented**
* `use_section` - {{% badge %}}Both{{% /badge %}} flag for some LTI Tool Providers that require special handling. This is not implemenetd within this library but may be handy for other uses.
* `createdAt` - {{% badge %}}Auto{{% /badge %}} creation timestamp
* `updatedAt` - {{% badge %}}Auto{{% /badge %}} last updated timestamp

### lti_provider_keys

This table stores the secrets associated with an LTI Tool Provider. It is stored in a separate table to prevent accidental modification through the `Provider` model directly. 

* `key` - {{% badge %}}Auto{{% /badge %}} shared key used to identify the LTI Tool Provider
* `secret` - {{% badge %}}LTI 1.0{{% /badge %}} shared secret with the LTI Tool Provider
title LTI 1.0 Launch

actor User
participant "LTI Tool Consumer\n(Canvas)" as TC
participant Browser
entryspacing 0.3
participantgroup #lightgrey Server
rparticipant LTI Router
rparticipant LTI Controller
rparticipant LTI Utility
database Database
end
participant User Code

TC->Browser: Display LTI Launch Page
User->Browser:           Click LTI Launch
Browser->LTI Router: <align:center>POST   \n/lti/provider/launch10   \n<LTI 1.0 Launch Data>   
activate LTI Router
LTI Router->LTI Controller: launch10(req)
activate LTI Controller
LTI Controller->LTI Utility: validate10(req)
activate LTI Utility
note over LTI Utility: <align:center>Validate Body\nValidate LTI Params\nValidate OAuth Params\nCheck OAuth Timestamp\nCheck OAuth Nonce
LTI Utility->Database: Find Secret
activate Database
Database->LTI Utility: LTI Secret
deactivate Database
note over LTI Utility: <align:center>Compute OAuth Signature\nValidate OAuth Signature
LTI Utility->LTI Controller: LTI Payload
deactivate LTI Utility
note over LTI Controller: Assemble Launch Data
LTI Controller->LTI Controller: #launch(launchData, req)
deactivate LTI Controller
activate LTI Controller
LTI Controller->Database: Find Consumer
activate Database
Database->LTI Controller: Consumer
deactivate Database
group if needed
LTI Controller->Database: Update Consumer
activate Database
Database->LTI Controller: //saved//
deactivate Database
end
LTI Controller->User Code: handleLaunch(launchData, consumer, req)
activate User Code
==User Code Work==
User Code->LTI Controller: Redirect URL
deactivate User Code
LTI Controller->LTI Router: Redirect URL
deactivate LTI Controller
LTI Router->Browser: Redirect URL
deactivate LTI Router
<!DOCTYPE html>
<html lang="en">
  <head>
    <title>{{ title }}</title>
  </head>
  <body>
    <main>
        <h1>LTI Toolkit Example - Instructor View</h1>
        {% if message %}
        <p style="color: green">{{ message }}
        {% endif %}
        {% if error %}
        <p style="color: red">{{ error }}
        {% endif %}
        {% for courseId, course in courses %}
          <h2>{{ course.name }} ({{ course.label }})</h2>
          <p>
            <ul>
              <li><b>ID: </b> {{ courseId }}</li>
            </ul>
          </p>
          {% for assignmentId, assignment in course.assignments %}
            <h3>{{ assignment.name }}</h3>
            <p>
              <ul>
                <li><b>ID: </b> {{ assignmentId }}</li>
                <li><b>LTI 1.3 ID: </b> {{ assignment.lti_id }}</li>
                <li><b>Passback URL: </b> {{ assignment.grade_url }}</li>
              </ul>
            </p>
            {% for userId, grade in assignment.grades %}
              <h4>{{ grade.name }}</h4>
              <p>
                <ul>
                  <li><b>ID: </b> {{ userId }}</li>
                  <li><b>LTI 1.3 ID: </b> {{ grade.lis13_id }}</li>
                  <li><b>Outcome ID: </b> {{ grade.outcome_id }}</li>
                  <li><b>Current Score: </b>{{ grade.score }}</li>
                  <li>
                    <form method="POST" action="/instructor/grade">
                      <label for="grade"><b>Update Grade: </b></label>
                      <input type="number" id="grade" name="grade" min="0" max="1" step="0.01">
                      <input type="hidden" id="assignment" name="assignment" value="{{ assignmentId }}">
                      <input type="hidden" id="user" name="user" value="{{ userId }}">
                      <input type="submit" value="Submit">
                    </form>
                  </li>
                </ul>
              </p>
            {% else %}
              <p>No students found!</p>
            {% endfor %}
          {% else %}
            <p>No assignments found!</p>
          {% endfor %}
        {% else %}
          <p>No courses found!</p>
        {% endfor %}
        <hr />
        <details>
          <summary>LTI Debugging Information</summary>
          <p><b>LTI Launch Data</b></p>
          <pre>
{{ launchData | dump(2) | safe }}
          </pre>
          <p><b>LTI Consumer</b></p>
          <pre>
{{ consumer | dump(2) | safe }}
          </pre>
        </details>
    </main>
  </body>
</html>